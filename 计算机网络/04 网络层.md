# 4.1 网络层提供的两种服务
- **虚电路服务和数据报服务**
- **网络层不提供服务质量的承诺**
# 4.2 网际协议IP
## 4.2.2 IP地址
### 1. 
### 2.
### 3.
### 4. IP地址的特点
1. IP地址是一种分等级的地址结构
2. IP地址是标志一台主机（或路由器）和一条链路的接口。当一台主机同时连接到多个网络中，会拥有多个IP地址，其网络前缀不同
3. 用转发器或交换机连接起来的若干个局域网仍为一个网络
4. 所有分配到网络前缀的网络都是平等的
## 4.2.3 IP地址与MAC地址


## 4.2.4 地址解析协议ARP
### 1. 基本定义

- ​**​全称​**​：地址解析协议
    
- ​**​核心任务​**​：根据已知的 ​**​IP 地址​**​ 解析出对应的 ​**​MAC 地址​**​
    
- ​**​所属层次​**​：工作在网络层与数据链路层之间
    

### 2. 为什么需要 ARP？

- 网络设备有两个关键地址：
    
    - ​**​IP 地址​**​（逻辑地址）：用于远程寻址，可变
        
    - ​**​MAC 地址​**​（物理地址）：用于本地网络直接通信，全球唯一
        
    
- 在局域网内，设备间最终通信依赖 MAC 地址，ARP 解决“IP → MAC”的映射问题
    


### 3. 工作流程（广播请求，单播应答）

#### 场景：

设备 A（IP_A, MAC_A）想通信的设备 B（IP_B），但不知 B 的 MAC 地址。

1. ​**​ARP 请求（广播）​**​
    
    - A 广播发送 ARP 请求包，内容包含：
        
        - 发送方 IP_A 和 MAC_A
            
        - 目标 IP_B
            
        - 目标 MAC 地址为 `FF:FF:FF:FF:FF:FF`（广播地址）
            
        
    
2. ​**​ARP 应答（单播）​**​
    
    - 所有设备收到请求，但只有 IP_B 的设备响应
        
    - B 单播回复 ARP 应答包，包含自己的 IP_B 和 MAC_B
        
    
3. ​**​更新 ARP 缓存​**​
    
    - A 收到应答后，将 `IP_B → MAC_B`存入 ​**​ARP 缓存表​**​
        
    - 后续通信直接查表，缓存有过期时间
        
    


### 4. ARP 缓存表

- 临时存储 `IP → MAC`映射关系
    
- 减少重复的 ARP 请求，提升效率
    
- 可通过命令查看（如 `arp -a`）
    
### 5.使用ARP的四种典型情况
- 发送方是主机，要把IP数据报转发到本网络上的另一个主机
	- 运行一次ARP协议
- 发送方是主机
- 发送方是路由器
- 发送方是路由器

## 4.2.5 IP数据报的格式
IP数据报的格式说明协议IP都具有什么功能
### 1. IP数据报首部的固定部分中的各字段
1. 版本：占四位，指协议IP的版本（IPv4、IPv6）
2. 首部长度：占四位，可表示的最大十进制数值是15
3. 区分长度：占八位，用来获得更好的服务，为**区分服务DS**，只有在使用区分长度时才起作用
4. 总长度：首部和数据之和的长度，总长度字段为16位

**最大传输单元MTU**：一个数据帧中数据字段的最大长度
# 4.3 IP层转发分组的过程
## 4.3.1 基于终点的转发
> 分组在互联网上传送和转发是基于分组首部中的目的地址的
